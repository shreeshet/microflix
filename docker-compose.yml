version: '3.0'
services:
  rediscache:
    image: 'redis:latest'
    ports:
      - '6379:6379'
    hostname: 'rediscache'
  serviceregistry:
    build:
      context: ./serviceregistry
    image: 'serviceregistry:0.1'
    ports:
      - '8761:8761'
    hostname: 'serviceregistry'
  gateway:
    build:
      context: ./gateway
    image: 'gateway:0.1'
    ports:
      - '8765:8080'
    hostname: 'gateway'
  movieservice:
    build:
      context: ./movieservice
    image: 'movieservice:0.1'
    depends_on:
      - rediscache
      - serviceregistry
    extra_hosts:
      - 'sakiladb:${SAKILADB_IP}'
  inventoryservice:
    build:
      context: ./inventoryservice
    image: 'inventoryservice:0.1'
    depends_on:
      - rediscache
      - serviceregistry
    extra_hosts:
      - 'sakiladb:${SAKILADB_IP}'
  userservice:
    build:
      context: ./userservice
    image: 'userservice:0.1'
    depends_on:
      - rediscache
      - serviceregistry
    extra_hosts:
      - 'sakiladb:${SAKILADB_IP}'
networks:
  default:
    external:
      name: micronet
